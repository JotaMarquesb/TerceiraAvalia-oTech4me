unit uCadastro;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes,
  Vcl.Graphics, Vcl.Controls, Vcl.Forms, Vcl.Dialogs, Vcl.StdCtrls,
  uContaBancaria, uDM, uTelaInicial;   // <-- IMPORTANTE: adicionar a tela inicial

type
  TfrmCadastro = class(TForm)
    lblTitularConta: TLabel;
    edtNomeTitular: TEdit;
    btnCriarConta: TButton;
    lblMensagem: TLabel;
    edtCPF: TEdit;
    Label1: TLabel;
    Label2: TLabel;
    btnVoltar: TButton;
    procedure btnCriarContaClick(Sender: TObject);
    procedure btnVoltarClick(Sender: TObject);
  private
  public
  end;

var
  frmCadastro: TfrmCadastro;

implementation

uses
  uLogin;

{$R *.dfm}

procedure TfrmCadastro.btnCriarContaClick(Sender: TObject);
var
  Conta: TContaBancaria;
begin
  if edtNomeTitular.Text = '' then
  begin
    lblMensagem.Caption := 'Informe o nome do titular.';
    Exit;
  end;

  if edtCPF.Text = '' then
  begin
    lblMensagem.Caption := 'Informe o CPF.';
    Exit;
  end;

  try
    Conta := DM.Banco.CriarConta(edtNomeTitular.Text, edtCPF.Text);
  except
    on E: Exception do
    begin
      lblMensagem.Caption := E.Message;
      Exit;
    end;
  end;

  ShowMessage(
      'Conta criada com sucesso!' + sLineBreak +
      'Titular: ' + Conta.Titular + sLineBreak +
      'CPF: ' + Conta.CPF + sLineBreak +
      'Número da conta: ' + Conta.NumeroConta
    );

  frmTelaInicial.DefinirConta(Conta);
  frmTelaInicial.Show;
  Self.Hide;
end;

procedure TfrmCadastro.btnVoltarClick(Sender: TObject);
begin
  fmrLogin.Show;
  Self.Hide;
end;

end.

